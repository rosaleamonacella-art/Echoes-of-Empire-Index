<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Echoes of Empire / A Collaborative Index</title>
  <meta name="description" content="A collaborative index of key terms, quotes, and frameworks for tracing the extractive geographies of empire across the Pacific Northwest and beyond." />
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500&family=IBM+Plex+Sans:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400&family=IBM+Plex+Mono:wght@300;400&display=swap" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { background: #fff; color: #000; font-family: 'IBM Plex Sans', sans-serif; -webkit-font-smoothing: antialiased; }
    ::selection { background: #000; color: #fff; }
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: #fff; }
    ::-webkit-scrollbar-thumb { background: #ddd; }
    ::-webkit-scrollbar-thumb:hover { background: #bbb; }
    input::placeholder { color: #bbb; }
    a { color: inherit; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideUp { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes expandLine { from { transform: scaleX(0); } to { transform: scaleX(1); } }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef, useMemo, useCallback } = React;

    const GOOGLE_SHEET_CSV_URL = "https://docs.google.com/spreadsheets/d/1qStdSPU3qhg27AYj88w8M19FiFc-6QU8ruJ1ghTEpcI/gviz/tq?tqx=out:csv";
    const GOOGLE_FORM_URL = "https://docs.google.com/forms/d/e/1FAIpQLSd6cMyiYdF8R8Fsx9i6vndMBsIaK0M48f_NqMwmOPjb5TnD8w/viewform";

    // ── Fonts ──
    const serif = "'Cormorant Garamond', Georgia, serif";
    const sans = "'IBM Plex Sans', sans-serif";
    const mono = "'IBM Plex Mono', monospace";

    // ── CSV Parser ──
    function parseCSVEntries(csvText) {
      const result = Papa.parse(csvText, { header: true, skipEmptyLines: true, transformHeader: h => h.trim() });
      return result.data
        .filter(row => { const t = row["Term"] || row["Name of Definition"] || ""; return t.trim() !== ""; })
        .map((row, i) => ({
          id: i + 1,
          term: (row["Term"] || row["Name of Definition"] || "").trim(),
          definition: (row["Definition Description"] || row["Definition"] || "").trim(),
          tags: (row["Tags"] || "").split(",").map(t => t.trim().toLowerCase()).filter(t => t),
          crossRefs: (row["Cross References"] || row["Cross-References"] || "").split(",").map(r => r.trim()).filter(r => r),
          citations: (row["Citation ( APA)"] || row["Citation (APA)"] || row["Citations"] || "").split(";").map(c => c.trim()).filter(c => c),
          author: (row["Author"] || "").trim(),
          date: (row["Date (Year)"] || row["Date"] || "").trim(),
          imageUrl: (row["Image URL"] || "").trim(),
          mediaUrl: (row["Media URL"] || "").trim(),
          submitter: (row["Name of person submitting entry (first name, surname)"] || row["Name of person submitting entry ( first name, surname)"] || "").trim(),
        }));
    }

    function useFetchEntries() {
      const [entries, setEntries] = useState([]);
      const [loading, setLoading] = useState(true);
      const [error, setError] = useState(null);
      useEffect(() => {
        if (GOOGLE_SHEET_CSV_URL === "YOUR_PUBLISHED_CSV_URL_HERE") { setLoading(false); return; }
        fetch(GOOGLE_SHEET_CSV_URL)
          .then(r => { if (!r.ok) throw new Error("Failed to fetch"); return r.text(); })
          .then(csv => { setEntries(parseCSVEntries(csv)); setLoading(false); })
          .catch(err => { setError(err.message); setLoading(false); });
      }, []);
      return { entries, loading, error };
    }

    const ALL_TAGS = (entries) => [...new Set(entries.flatMap(e => e.tags))].sort();

    // ── Network Graph ──
    const NetworkGraph = ({ entries, onNodeClick, activeTags, searchQuery }) => {
      const svgRef = useRef(null);
      const containerRef = useRef(null);
      const [dims, setDims] = useState({ width: 900, height: 600 });
      const [hovered, setHovered] = useState(null);

      const filtered = useMemo(() => entries.filter(e => {
        const s = searchQuery === "" || e.term.toLowerCase().includes(searchQuery.toLowerCase()) || e.definition.toLowerCase().includes(searchQuery.toLowerCase()) || e.tags.some(t => t.includes(searchQuery.toLowerCase()));
        const t = activeTags.length === 0 || activeTags.every(tag => e.tags.includes(tag));
        return s && t;
      }), [entries, activeTags, searchQuery]);

      const graph = useMemo(() => {
        const termSet = new Set(filtered.map(e => e.term));
        const nodes = filtered.map(e => ({ id: e.term, tags: e.tags, refCount: e.crossRefs.filter(r => termSet.has(r)).length, entry: e }));
        const links = [];
        filtered.forEach(entry => {
          entry.crossRefs.forEach(ref => { if (termSet.has(ref) && entry.term < ref) links.push({ source: entry.term, target: ref }); });
        });
        const paired = new Set(links.map(l => `${l.source}||${l.target}`));
        filtered.forEach((a, i) => { filtered.forEach((b, j) => {
          if (i < j) { const k = a.term < b.term ? `${a.term}||${b.term}` : `${b.term}||${a.term}`;
            if (!paired.has(k)) { const sh = a.tags.filter(t => b.tags.includes(t)); if (sh.length >= 2) links.push({ source: a.term, target: b.term, weak: true, shared: sh.length }); }
          }
        }); });
        return { nodes, links };
      }, [filtered]);

      useEffect(() => {
        const obs = new ResizeObserver(([e]) => setDims({ width: e.contentRect.width, height: Math.max(450, e.contentRect.height) }));
        if (containerRef.current) obs.observe(containerRef.current);
        return () => obs.disconnect();
      }, []);

      useEffect(() => {
        if (!svgRef.current || graph.nodes.length === 0) return;
        const { width, height } = dims;
        const svg = d3.select(svgRef.current); svg.selectAll("*").remove();
        const g = svg.append("g");
        svg.call(d3.zoom().scaleExtent([0.3, 4]).on("zoom", e => g.attr("transform", e.transform)));

        const sim = d3.forceSimulation(graph.nodes)
          .force("link", d3.forceLink(graph.links).id(d => d.id).distance(d => d.weak ? 160 : 100).strength(d => d.weak ? 0.04 : 0.25))
          .force("charge", d3.forceManyBody().strength(-250))
          .force("center", d3.forceCenter(width / 2, height / 2))
          .force("collision", d3.forceCollide().radius(40));

        const link = g.append("g").selectAll("line").data(graph.links).join("line")
          .attr("stroke", d => d.weak ? "#eee" : "#ccc")
          .attr("stroke-width", d => d.weak ? 0.5 : 1)
          .attr("stroke-dasharray", d => d.weak ? "3,6" : "none");

        const node = g.append("g").selectAll("g").data(graph.nodes).join("g").style("cursor", "pointer")
          .call(d3.drag()
            .on("start", (e, d) => { if (!e.active) sim.alphaTarget(0.3).restart(); d.fx = d.x; d.fy = d.y; })
            .on("drag", (e, d) => { d.fx = e.x; d.fy = e.y; })
            .on("end", (e, d) => { if (!e.active) sim.alphaTarget(0); d.fx = null; d.fy = null; })
          );

        node.append("circle").attr("r", d => 3.5 + d.refCount * 2)
          .attr("fill", "#fff").attr("stroke", "#000").attr("stroke-width", 1);
        node.append("text").text(d => d.id)
          .attr("dx", d => 8 + d.refCount * 1.5).attr("dy", "0.35em")
          .attr("fill", "#000").attr("font-family", serif).attr("font-size", d => `${13 + d.refCount}px`).attr("font-weight", 500).attr("font-style", "italic");

        node.on("mouseenter", function(ev, d) {
          setHovered(d.id);
          const conn = new Set([d.id]);
          graph.links.forEach(l => { const s = typeof l.source === "object" ? l.source.id : l.source; const t = typeof l.target === "object" ? l.target.id : l.target; if (s === d.id) conn.add(t); if (t === d.id) conn.add(s); });
          node.select("circle").attr("stroke", n => conn.has(n.id) ? "#000" : "#ddd").attr("stroke-width", n => n.id === d.id ? 2 : conn.has(n.id) ? 1.5 : 0.5).attr("fill", n => n.id === d.id ? "#000" : "#fff");
          node.select("text").attr("fill", n => conn.has(n.id) ? "#000" : "#ccc").attr("font-weight", n => n.id === d.id ? 700 : 500);
          link.attr("stroke", l => { const s = typeof l.source === "object" ? l.source.id : l.source; const t = typeof l.target === "object" ? l.target.id : l.target; return (s === d.id || t === d.id) ? "#000" : "#eee"; })
            .attr("stroke-width", l => { const s = typeof l.source === "object" ? l.source.id : l.source; const t = typeof l.target === "object" ? l.target.id : l.target; return (s === d.id || t === d.id) ? 1.5 : 0.5; });
        })
        .on("mouseleave", function() {
          setHovered(null);
          node.select("circle").attr("stroke", "#000").attr("stroke-width", 1).attr("fill", "#fff");
          node.select("text").attr("fill", "#000").attr("font-weight", 500);
          link.attr("stroke", d => d.weak ? "#eee" : "#ccc").attr("stroke-width", d => d.weak ? 0.5 : 1);
        })
        .on("click", (ev, d) => onNodeClick(d.entry));

        sim.on("tick", () => {
          link.attr("x1", d => d.source.x).attr("y1", d => d.source.y).attr("x2", d => d.target.x).attr("y2", d => d.target.y);
          node.attr("transform", d => `translate(${d.x},${d.y})`);
        });
        return () => sim.stop();
      }, [graph, dims, onNodeClick]);

      if (!entries.length || !filtered.length) return (
        <div ref={containerRef} style={{ width: "100%", height: "500px", display: "flex", alignItems: "center", justifyContent: "center", borderTop: "1px solid #000", borderBottom: "1px solid #000" }}>
          <p style={{ fontFamily: serif, fontSize: "18px", fontStyle: "italic", color: "#999" }}>{entries.length === 0 ? "No entries yet." : "No entries match your current filters."}</p>
        </div>
      );

      return (
        <div ref={containerRef} style={{ width: "100%", height: "600px", position: "relative", borderTop: "1px solid #000", borderBottom: "1px solid #000" }}>
          <svg ref={svgRef} width={dims.width} height={dims.height} style={{ width: "100%", height: "100%" }} />
          {hovered && <div style={{ position: "absolute", bottom: "16px", left: "0", fontFamily: mono, fontSize: "10px", letterSpacing: "0.05em", color: "#aaa" }}>Click to expand  /  Drag to rearrange  /  Scroll to zoom</div>}
        </div>
      );
    };

    // ── Entry Block (Editorial) ──
    const EntryBlock = ({ entry, onTagClick, onTermClick, isExpanded, onToggle, index }) => {
      const [hover, setHover] = useState(false);

      const attribution = [entry.author, entry.submitter].filter(Boolean).join(" / ");
      const meta = [attribution, entry.date].filter(Boolean).join(", ");

      return (
        <article
          onClick={onToggle}
          onMouseEnter={() => setHover(true)}
          onMouseLeave={() => setHover(false)}
          style={{
            padding: isExpanded ? "48px 0" : "32px 0",
            borderBottom: "1px solid #000",
            cursor: "pointer",
            transition: "padding 0.4s ease",
          }}
        >
          {/* Header row */}
          <div style={{ display: "flex", alignItems: "baseline", justifyContent: "space-between", gap: "24px" }}>
            <h3 style={{
              fontFamily: serif, fontSize: isExpanded ? "36px" : "28px", fontWeight: 500,
              lineHeight: 1.15, letterSpacing: "-0.01em",
              color: "#000", transition: "font-size 0.4s ease",
            }}>{entry.term}</h3>
            <div style={{ display: "flex", alignItems: "baseline", gap: "16px", flexShrink: 0 }}>
              {!isExpanded && entry.tags.length > 0 && (
                <span style={{ fontFamily: mono, fontSize: "10px", color: "#999", letterSpacing: "0.03em" }}>
                  {entry.tags.slice(0, 3).join(", ")}{entry.tags.length > 3 ? ` +${entry.tags.length - 3}` : ""}
                </span>
              )}
              <span style={{
                fontFamily: mono, fontSize: "11px", color: "#999",
                transform: isExpanded ? "rotate(90deg)" : "rotate(0deg)",
                transition: "transform 0.3s ease", display: "inline-block",
              }}>&rarr;</span>
            </div>
          </div>

          {/* Expanded content */}
          <div style={{
            maxHeight: isExpanded ? "2000px" : "0", overflow: "hidden",
            transition: "max-height 0.6s cubic-bezier(0.25, 0.1, 0.25, 1), opacity 0.4s ease",
            opacity: isExpanded ? 1 : 0,
          }}>
            <div style={{ marginTop: "28px", display: "grid", gridTemplateColumns: "1fr 280px", gap: "48px", alignItems: "start" }}>
              {/* Left: definition + citations */}
              <div>
                <p style={{
                  fontFamily: serif, fontSize: "19px", lineHeight: 1.75, color: "#333",
                  fontWeight: 400, maxWidth: "580px",
                }}>{entry.definition}</p>

                {entry.imageUrl && (
                  <div style={{ marginTop: "24px" }}>
                    <img src={entry.imageUrl} alt={entry.term} style={{ maxWidth: "100%", maxHeight: "320px", objectFit: "contain", display: "block" }} />
                  </div>
                )}

                {entry.citations.length > 0 && (
                  <div style={{ marginTop: "28px", paddingLeft: "20px", borderLeft: "2px solid #000" }}>
                    {entry.citations.map((c, i) => (
                      <p key={i} style={{ fontFamily: sans, fontSize: "13px", lineHeight: 1.65, color: "#666", marginBottom: i < entry.citations.length - 1 ? "8px" : "0" }}>{c}</p>
                    ))}
                  </div>
                )}

                {entry.mediaUrl && (
                  <div style={{ marginTop: "20px" }}>
                    <a href={entry.mediaUrl} target="_blank" rel="noopener noreferrer"
                      style={{ fontFamily: mono, fontSize: "11px", color: "#000", letterSpacing: "0.03em", borderBottom: "1px solid #000", textDecoration: "none", paddingBottom: "2px" }}>
                      View media &nearr;
                    </a>
                  </div>
                )}
              </div>

              {/* Right: metadata sidebar */}
              <div style={{ paddingTop: "4px" }}>
                {entry.tags.length > 0 && (
                  <div style={{ marginBottom: "24px" }}>
                    <span style={{ fontFamily: mono, fontSize: "9px", letterSpacing: "0.12em", textTransform: "uppercase", color: "#999", display: "block", marginBottom: "10px" }}>Tags</span>
                    <div style={{ display: "flex", flexWrap: "wrap", gap: "6px" }}>
                      {entry.tags.map(tag => (
                        <span key={tag} onClick={e => { e.stopPropagation(); onTagClick(tag); }}
                          style={{
                            fontFamily: mono, fontSize: "10px", padding: "4px 10px",
                            border: "1px solid #000", color: "#000", letterSpacing: "0.03em",
                            cursor: "pointer", transition: "all 0.15s ease", background: "#fff",
                          }}
                          onMouseEnter={e => { e.target.style.background = "#000"; e.target.style.color = "#fff"; }}
                          onMouseLeave={e => { e.target.style.background = "#fff"; e.target.style.color = "#000"; }}
                        >{tag}</span>
                      ))}
                    </div>
                  </div>
                )}

                {entry.crossRefs.length > 0 && (
                  <div style={{ marginBottom: "24px" }}>
                    <span style={{ fontFamily: mono, fontSize: "9px", letterSpacing: "0.12em", textTransform: "uppercase", color: "#999", display: "block", marginBottom: "10px" }}>See also</span>
                    {entry.crossRefs.map((ref, i) => (
                      <div key={ref} style={{ marginBottom: "4px" }}>
                        <span onClick={e => { e.stopPropagation(); onTermClick(ref); }}
                          style={{ fontFamily: serif, fontSize: "15px", fontStyle: "italic", color: "#000", cursor: "pointer", borderBottom: "1px solid #ccc", transition: "border-color 0.2s ease" }}
                          onMouseEnter={e => e.target.style.borderBottomColor = "#000"}
                          onMouseLeave={e => e.target.style.borderBottomColor = "#ccc"}
                        >{ref}</span>
                      </div>
                    ))}
                  </div>
                )}

                {meta && (
                  <div>
                    <span style={{ fontFamily: mono, fontSize: "9px", letterSpacing: "0.12em", textTransform: "uppercase", color: "#999", display: "block", marginBottom: "8px" }}>Attribution</span>
                    <span style={{ fontFamily: sans, fontSize: "12px", color: "#666", lineHeight: 1.5 }}>{meta}</span>
                  </div>
                )}
              </div>
            </div>
          </div>
        </article>
      );
    };

    // ── Main App ──
    function App() {
      const { entries, loading, error } = useFetchEntries();
      const [search, setSearch] = useState("");
      const [activeTags, setActiveTags] = useState([]);
      const [expandedId, setExpandedId] = useState(null);
      const [view, setView] = useState("list");
      const [sort, setSort] = useState("alpha");
      const [showAbout, setShowAbout] = useState(false);
      const [netDetail, setNetDetail] = useState(null);
      const [loaded, setLoaded] = useState(false);

      useEffect(() => { setTimeout(() => setLoaded(true), 50); }, []);

      const allTags = useMemo(() => ALL_TAGS(entries), [entries]);
      const toggleTag = tag => setActiveTags(p => p.includes(tag) ? p.filter(t => t !== tag) : [...p, tag]);
      const navTerm = name => { const e = entries.find(x => x.term === name); if (e) { setExpandedId(e.id); setSearch(""); setActiveTags([]); setView("list"); } };
      const onNetClick = useCallback(e => setNetDetail(p => p && p.id === e.id ? null : e), []);

      const filtered = useMemo(() => {
        const f = entries.filter(e => {
          const ms = search === "" || e.term.toLowerCase().includes(search.toLowerCase()) || e.definition.toLowerCase().includes(search.toLowerCase()) || e.tags.some(t => t.includes(search.toLowerCase()));
          const mt = activeTags.length === 0 || activeTags.every(tag => e.tags.includes(tag));
          return ms && mt;
        });
        if (sort === "alpha") return f.sort((a, b) => a.term.localeCompare(b.term));
        if (sort === "chrono") return f.sort((a, b) => new Date(b.date) - new Date(a.date));
        if (sort === "tags") return f.sort((a, b) => b.tags.length - a.tags.length);
        return f;
      }, [entries, search, activeTags, sort]);

      const controlBtn = (label, active, fn) => (
        <button onClick={fn} style={{
          fontFamily: mono, fontSize: "10px", letterSpacing: "0.05em",
          padding: "5px 12px", background: active ? "#000" : "#fff",
          border: "1px solid #000", color: active ? "#fff" : "#000",
          cursor: "pointer", transition: "all 0.15s ease",
        }}
          onMouseEnter={e => { if (!active) { e.target.style.background = "#f5f5f5"; } }}
          onMouseLeave={e => { if (!active) { e.target.style.background = "#fff"; } }}
        >{label}</button>
      );

      return (
        <div style={{
          minHeight: "100vh", background: "#fff", color: "#000",
          opacity: loaded ? 1 : 0, transition: "opacity 0.6s ease",
        }}>
          {/* Top rule */}
          <div style={{ height: "3px", background: "#000" }} />

          <div style={{ maxWidth: "1080px", margin: "0 auto", padding: "0 40px" }}>

            {/* Header */}
            <header style={{ paddingTop: "48px", paddingBottom: "40px" }}>
              <div style={{ display: "flex", justifyContent: "space-between", alignItems: "baseline", marginBottom: "32px" }}>
                <span style={{ fontFamily: mono, fontSize: "10px", letterSpacing: "0.1em", textTransform: "uppercase", color: "#999" }}>Harvard GSD / Option Studio / Spring 2026</span>
                <span style={{ fontFamily: mono, fontSize: "10px", letterSpacing: "0.1em", color: "#999" }}>{entries.length} {entries.length === 1 ? "entry" : "entries"}</span>
              </div>

              <h1 style={{
                fontFamily: serif, fontSize: "clamp(48px, 7vw, 80px)", fontWeight: 400,
                lineHeight: 0.95, color: "#000", letterSpacing: "-0.02em", marginBottom: "12px",
              }}>Echoes of Empire</h1>

              <h2 style={{
                fontFamily: serif, fontSize: "clamp(20px, 3vw, 32px)", fontWeight: 300,
                fontStyle: "italic", color: "#999", marginBottom: "32px",
              }}>A Collaborative Index</h2>

              <div style={{ height: "1px", background: "#000", transformOrigin: "left", animation: "expandLine 0.8s ease forwards", marginBottom: "28px" }} />

              <p style={{
                fontFamily: serif, fontSize: "17px", lineHeight: 1.75, color: "#666",
                maxWidth: "640px", fontWeight: 400,
              }}>
                A collaborative index of key terms, quotes, and frameworks for tracing the extractive geographies of empire across the Pacific Northwest and beyond.
              </p>

              <div style={{ display: "flex", gap: "12px", marginTop: "28px", flexWrap: "wrap" }}>
                <button onClick={() => setShowAbout(!showAbout)} style={{
                  fontFamily: mono, fontSize: "10px", letterSpacing: "0.08em",
                  padding: "8px 18px", background: showAbout ? "#000" : "#fff",
                  border: "1px solid #000", color: showAbout ? "#fff" : "#000",
                  cursor: "pointer", transition: "all 0.15s ease",
                }}
                  onMouseEnter={e => { if (!showAbout) e.target.style.background = "#f5f5f5"; }}
                  onMouseLeave={e => { if (!showAbout) e.target.style.background = "#fff"; }}
                >{showAbout ? "Close" : "About"}</button>

                <a href={GOOGLE_FORM_URL} target="_blank" rel="noopener noreferrer" style={{
                  fontFamily: mono, fontSize: "10px", letterSpacing: "0.08em",
                  padding: "8px 18px", background: "#000", border: "1px solid #000",
                  color: "#fff", textDecoration: "none", display: "inline-block", transition: "all 0.15s ease",
                }}
                  onMouseEnter={e => { e.target.style.background = "#333"; }}
                  onMouseLeave={e => { e.target.style.background = "#000"; }}
                >+ Submit Entry</a>
              </div>

              {showAbout && (
                <div style={{ marginTop: "32px", animation: "slideUp 0.4s ease forwards" }}>
                  <div style={{ borderTop: "1px solid #000", paddingTop: "28px", display: "grid", gridTemplateColumns: "1fr 1fr", gap: "32px" }}>
                    <div>
                      <p style={{ fontFamily: serif, fontSize: "16px", lineHeight: 1.8, color: "#444", marginBottom: "16px" }}>
                        This index is part of <em>Echoes of Empire</em>, an option studio at the Harvard Graduate School of Design (Spring 2026), instructed by Rosalea Monacella. It operates as a collectively authored map of the conceptual terrain through which the studio moves, tracing the extractive geographies celebrated by the 1924 British Empire Exhibition at Wembley and their present condition in the midst of planetary crisis. Each term is a node in a larger network of ideas connecting empire, extraction, landscape, climate, Indigenous sovereignty, and reparative design.
                      </p>
                      <p style={{ fontFamily: serif, fontSize: "16px", lineHeight: 1.8, color: "#444", marginBottom: "16px" }}>
                        Canada's Pacific Northwest is experiencing accelerating glacial retreat, intensifying atmospheric rivers, prolonged drought, and increasing wildfires. These events affect not only humans but also render more-than-human ecologies vulnerable. The relentless pursuit of economic growth fuels an ever-expanding demand for resource extraction, erasing, reshaping, and altering cultures while terraforming landscapes. This drive for control over resources, environments, and people accelerates extraction, destroying biodiversity zones, displacing communities, and exacerbating racial, social, and economic disparities as they become more deeply woven into the planetary polycrisis.
                      </p>
                      <p style={{ fontFamily: serif, fontSize: "16px", lineHeight: 1.8, color: "#444", marginBottom: "16px" }}>
                        The British Empire Exhibition at Wembley in 1924 showcased British colonies and their valuable natural resources as evidence of the empire's extractive triumph. The exhibition presented Canada as an inexhaustible resource, highlighting the nation's timber wealth and mineral abundance as evidence of the empire's prosperity. This option studio revisits that exhibition to trace the extractive geographies it celebrated and their present condition in the midst of planetary crisis. The Pacific Northwest region of Canada, particularly the historical 'All Red Line' corridor, will be the focus area of the option studio. Built alongside the Canadian Pacific Railway, the 'All Red Line' established physical corridors and stamped a colonial logic along which communication and resource flows passed exclusively through state-controlled territory, a jurisdictional claim that continues to be invoked today to route pipelines across unceded lands.
                      </p>
                    </div>
                    <div>
                      <p style={{ fontFamily: serif, fontSize: "16px", lineHeight: 1.8, color: "#444", marginBottom: "16px" }}>
                        This option studio redefines delineated resource grounds, infrastructure, waste byproducts, and atmospheric territories as a "thickened ground" condition encompassing interconnected, non-scalable processes and flows. The "thickened ground" will be explored as an alternative ontology in which processes do not distinguish between substance and significance, nor between nature and culture. Commonwealth nations share interconnected histories shaped by the British Empire's consolidation of power through resource exploitation, Indigenous displacement, migrant labor, and large-scale extractive practices. These shared legacies present an opportunity for the option studio to design future scenarios that seek alternatives to the historical regimes of expansion, resisting colonial attitudes and systems of perpetual growth through the exploration of alternative regimes of power, property, and production through techno-ecological relationships within a framework of territorial commons.
                      </p>
                      <p style={{ fontFamily: serif, fontSize: "16px", lineHeight: 1.8, color: "#444", marginBottom: "16px" }}>
                        Each student will investigate extractive geographies through archival research and the creation of counter-narratives. Students will assemble these records into a Counter-Empire Exhibition, located in the extractive geographies, where the landscapes can suggest reparative design actions. Students will choose architectural, landscape, and infrastructural elements such as pavilions, infrastructures, gardens, or convening rooms from the 1924 exhibition and reimagine them as reparative spatial proposals aligned with current Commonwealth policy, including the Living Lands Charter and the Apia Ocean Declaration.
                      </p>
                      <p style={{ fontFamily: serif, fontSize: "16px", lineHeight: 1.8, color: "#444", marginBottom: "16px" }}>
                        The studio consists of four phases: Phase 01: From Above, Counter-Narratives; Phase 02: From Within, Land and Energy as Medium (including a field trip to London for archival research at the V&A, the National Archives, the Imperial War Museum, Kew Gardens and the Commonwealth Secretariat); Phase 03: From Below, Future-Kin; Phase 04: The Counter-Empire Exhibition.
                      </p>
                      <p style={{ fontFamily: serif, fontSize: "16px", lineHeight: 1.8, color: "#444" }}>
                        The teaching and learning schedule includes a series of guest lectures and a range of mapping, narrative, film and modelling workshops aligned with each of the phases.
                      </p>
                    </div>
                  </div>
                </div>
              )}
            </header>

            {/* Controls */}
            {!loading && (
              <div style={{ borderTop: "1px solid #000", paddingTop: "24px", paddingBottom: "24px" }}>
                {/* Search */}
                <div style={{ position: "relative", marginBottom: "20px" }}>
                  <input type="text" value={search} onChange={e => setSearch(e.target.value)} placeholder="Search terms, definitions, tags..."
                    style={{
                      width: "100%", fontFamily: serif, fontSize: "18px", fontStyle: "italic",
                      padding: "12px 0", background: "transparent", border: "none",
                      borderBottom: "1px solid #ddd", color: "#000", outline: "none",
                      transition: "border-color 0.3s ease",
                    }}
                    onFocus={e => e.target.style.borderBottomColor = "#000"}
                    onBlur={e => e.target.style.borderBottomColor = "#ddd"}
                  />
                  {search && <span onClick={() => setSearch("")} style={{ position: "absolute", right: 0, top: "50%", transform: "translateY(-50%)", fontFamily: mono, fontSize: "10px", color: "#999", cursor: "pointer", letterSpacing: "0.05em" }}>Clear</span>}
                </div>

                {/* View + Sort row */}
                <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", flexWrap: "wrap", gap: "12px", marginBottom: "16px" }}>
                  <div style={{ display: "flex", gap: "4px", alignItems: "center" }}>
                    <span style={{ fontFamily: mono, fontSize: "9px", letterSpacing: "0.12em", textTransform: "uppercase", color: "#999", marginRight: "8px" }}>View</span>
                    {controlBtn("Index", view === "list", () => { setView("list"); setNetDetail(null); })}
                    {controlBtn("Network", view === "network", () => setView("network"))}
                  </div>
                  {view === "list" && (
                    <div style={{ display: "flex", gap: "4px", alignItems: "center" }}>
                      <span style={{ fontFamily: mono, fontSize: "9px", letterSpacing: "0.12em", textTransform: "uppercase", color: "#999", marginRight: "8px" }}>Sort</span>
                      {controlBtn("A\u2013Z", sort === "alpha", () => setSort("alpha"))}
                      {controlBtn("Recent", sort === "chrono", () => setSort("chrono"))}
                      {controlBtn("Tags", sort === "tags", () => setSort("tags"))}
                    </div>
                  )}
                </div>

                {/* Tag filters */}
                {allTags.length > 0 && (
                  <div style={{ display: "flex", flexWrap: "wrap", gap: "6px", alignItems: "center" }}>
                    <span style={{ fontFamily: mono, fontSize: "9px", letterSpacing: "0.12em", textTransform: "uppercase", color: "#999", marginRight: "8px" }}>Filter</span>
                    {allTags.map(tag => {
                      const active = activeTags.includes(tag);
                      return <span key={tag} onClick={() => toggleTag(tag)} style={{
                        fontFamily: mono, fontSize: "10px", padding: "3px 10px",
                        border: `1px solid ${active ? "#000" : "#ccc"}`,
                        color: active ? "#fff" : "#666",
                        background: active ? "#000" : "#fff",
                        cursor: "pointer", transition: "all 0.15s ease",
                      }}>{tag}</span>;
                    })}
                    {activeTags.length > 0 && <span onClick={() => setActiveTags([])} style={{ fontFamily: mono, fontSize: "10px", color: "#999", cursor: "pointer", marginLeft: "8px" }}>&times; Clear</span>}
                  </div>
                )}

                <div style={{ fontFamily: mono, fontSize: "10px", color: "#bbb", marginTop: "16px", letterSpacing: "0.03em" }}>
                  {entries.length === 0 ? "No entries yet" : `${filtered.length} of ${entries.length} ${entries.length === 1 ? "entry" : "entries"}`}
                </div>
              </div>
            )}

            {/* Loading */}
            {loading && <div style={{ padding: "80px 0", textAlign: "center" }}><p style={{ fontFamily: serif, fontSize: "16px", fontStyle: "italic", color: "#bbb" }}>Loading index...</p></div>}

            {/* Error */}
            {error && <div style={{ padding: "40px 0", textAlign: "center" }}><p style={{ fontFamily: sans, fontSize: "13px", color: "#c00" }}>Error: {error}</p></div>}

            {/* Network View */}
            {!loading && view === "network" ? (
              <div>
                <NetworkGraph entries={entries} onNodeClick={onNetClick} activeTags={activeTags} searchQuery={search} />
                {netDetail && (
                  <div style={{ padding: "40px 0", borderBottom: "1px solid #000", animation: "slideUp 0.3s ease forwards" }}>
                    <div style={{ display: "flex", justifyContent: "space-between", alignItems: "baseline", marginBottom: "20px" }}>
                      <h3 style={{ fontFamily: serif, fontSize: "32px", fontWeight: 500, color: "#000" }}>{netDetail.term}</h3>
                      <span onClick={() => setNetDetail(null)} style={{ fontFamily: mono, fontSize: "10px", color: "#999", cursor: "pointer" }}>&times; Close</span>
                    </div>
                    <div style={{ display: "grid", gridTemplateColumns: "1fr 280px", gap: "48px" }}>
                      <div>
                        <p style={{ fontFamily: serif, fontSize: "18px", lineHeight: 1.75, color: "#444" }}>{netDetail.definition}</p>
                        {netDetail.citations.length > 0 && (
                          <div style={{ marginTop: "24px", paddingLeft: "20px", borderLeft: "2px solid #000" }}>
                            {netDetail.citations.map((c, i) => <p key={i} style={{ fontFamily: sans, fontSize: "13px", lineHeight: 1.6, color: "#666", marginBottom: "6px" }}>{c}</p>)}
                          </div>
                        )}
                      </div>
                      <div>
                        {netDetail.tags.length > 0 && (
                          <div style={{ marginBottom: "20px" }}>
                            <span style={{ fontFamily: mono, fontSize: "9px", letterSpacing: "0.12em", textTransform: "uppercase", color: "#999", display: "block", marginBottom: "8px" }}>Tags</span>
                            <div style={{ display: "flex", flexWrap: "wrap", gap: "6px" }}>
                              {netDetail.tags.map(t => <span key={t} style={{ fontFamily: mono, fontSize: "10px", padding: "3px 8px", border: "1px solid #000", color: "#000" }}>{t}</span>)}
                            </div>
                          </div>
                        )}
                        {netDetail.crossRefs.length > 0 && (
                          <div style={{ marginBottom: "20px" }}>
                            <span style={{ fontFamily: mono, fontSize: "9px", letterSpacing: "0.12em", textTransform: "uppercase", color: "#999", display: "block", marginBottom: "8px" }}>See also</span>
                            {netDetail.crossRefs.map(r => <div key={r} style={{ marginBottom: "4px" }}><span onClick={() => { const x = entries.find(e => e.term === r); if (x) setNetDetail(x); }} style={{ fontFamily: serif, fontSize: "15px", fontStyle: "italic", color: "#000", cursor: "pointer", borderBottom: "1px solid #ccc" }}>{r}</span></div>)}
                          </div>
                        )}
                        <span style={{ fontFamily: mono, fontSize: "9px", letterSpacing: "0.12em", textTransform: "uppercase", color: "#999", display: "block", marginBottom: "6px" }}>Attribution</span>
                        <span style={{ fontFamily: sans, fontSize: "12px", color: "#666" }}>{[netDetail.author, netDetail.submitter].filter(Boolean).join(" / ")}{netDetail.date ? `, ${netDetail.date}` : ""}</span>
                      </div>
                    </div>
                  </div>
                )}
              </div>

            ) : !loading && (
              /* List View */
              <div style={{ borderTop: "1px solid #000" }}>
                {entries.length === 0 ? (
                  <div style={{ padding: "100px 0", textAlign: "center" }}>
                    <p style={{ fontFamily: serif, fontSize: "20px", fontStyle: "italic", color: "#bbb", marginBottom: "12px" }}>This index is waiting for its first entry.</p>
                    <p style={{ fontFamily: mono, fontSize: "10px", color: "#ccc" }}>Use the Submit Entry button above to contribute.</p>
                  </div>
                ) : filtered.length === 0 ? (
                  <div style={{ padding: "80px 0", textAlign: "center" }}>
                    <p style={{ fontFamily: serif, fontSize: "18px", fontStyle: "italic", color: "#bbb" }}>No entries match your search.</p>
                  </div>
                ) : filtered.map((entry, i) => (
                  <div key={entry.id} style={{ animation: `slideUp 0.4s ease ${i * 0.04}s forwards`, opacity: 0 }}>
                    <EntryBlock entry={entry} onTagClick={toggleTag} onTermClick={navTerm} isExpanded={expandedId === entry.id} onToggle={() => setExpandedId(expandedId === entry.id ? null : entry.id)} index={i} />
                  </div>
                ))}
              </div>
            )}

            {/* Footer */}
            <footer style={{ marginTop: "80px", paddingTop: "20px", paddingBottom: "48px", borderTop: "1px solid #000", display: "flex", justifyContent: "space-between", alignItems: "center" }}>
              <span style={{ fontFamily: mono, fontSize: "9px", letterSpacing: "0.1em", textTransform: "uppercase", color: "#bbb" }}>Echoes of Empire / Harvard GSD / 2026</span>
              <span style={{ fontFamily: mono, fontSize: "9px", letterSpacing: "0.1em", color: "#bbb" }}>&#9679; Live</span>
            </footer>
          </div>
        </div>
      );
    }

    ReactDOM.render(<App />, document.getElementById("root"));
  </script>
</body>
</html>
